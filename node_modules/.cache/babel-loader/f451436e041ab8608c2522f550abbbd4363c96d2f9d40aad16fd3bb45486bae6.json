{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback } from \"react\";\nexport const useGraphView = containerRef => {\n  _s();\n  const [view, setView] = useState({\n    x: 0,\n    y: 0,\n    zoom: 1\n  });\n  const [isPanning, setIsPanning] = useState(false);\n  const [panStartMouse, setPanStartMouse] = useState(null);\n\n  // Helper: Convert Screen (Mouse) coords to World (Graph) coords\n  const getMousePos = useCallback(e => {\n    if (!containerRef.current) return {\n      x: 0,\n      y: 0\n    };\n    const rect = containerRef.current.getBoundingClientRect();\n    return {\n      x: (e.clientX - rect.left - view.x) / view.zoom,\n      y: (e.clientY - rect.top - view.y) / view.zoom\n    };\n  }, [view, containerRef]);\n\n  // Handle Zoom and Pan via Wheel\n  const handleWheel = useCallback(e => {\n    // Ctrl+Scroll -> Zoom\n    if (e.ctrlKey || e.metaKey) {\n      e.preventDefault();\n      if (!containerRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      const screenX = e.clientX - rect.left;\n      const screenY = e.clientY - rect.top;\n\n      // World position before zoom\n      const worldX = (screenX - view.x) / view.zoom;\n      const worldY = (screenY - view.y) / view.zoom;\n\n      // Calc new zoom\n      const delta = -e.deltaY * 0.001;\n      const newZoom = Math.min(Math.max(0.1, view.zoom * (1 + delta)), 5);\n\n      // Adjust Pan to keep mouse over same world point\n      const newX = screenX - worldX * newZoom;\n      const newY = screenY - worldY * newZoom;\n      setView({\n        x: newX,\n        y: newY,\n        zoom: newZoom\n      });\n    } else {\n      // Standard Pan (Shift+Scroll or Trackpad)\n      setView(prev => ({\n        ...prev,\n        x: prev.x - e.deltaX,\n        y: prev.y - e.deltaY\n      }));\n    }\n  }, [view]);\n\n  // Manual Panning Handlers (Middle Mouse / Spacebar)\n  const startPan = e => {\n    setIsPanning(true);\n    setPanStartMouse({\n      x: e.clientX,\n      y: e.clientY\n    });\n  };\n  const updatePan = e => {\n    if (!isPanning || !panStartMouse) return;\n    const dx = e.clientX - panStartMouse.x;\n    const dy = e.clientY - panStartMouse.y;\n    setView(prev => ({\n      ...prev,\n      x: prev.x + dx,\n      y: prev.y + dy\n    }));\n    setPanStartMouse({\n      x: e.clientX,\n      y: e.clientY\n    });\n  };\n  const endPan = () => {\n    setIsPanning(false);\n    setPanStartMouse(null);\n  };\n  return {\n    view,\n    setView,\n    isPanning,\n    getMousePos,\n    handleWheel,\n    startPan,\n    updatePan,\n    endPan\n  };\n};\n_s(useGraphView, \"yX7VnXzav8ZCzajUOy7OKyMW+kQ=\");","map":{"version":3,"names":["useState","useCallback","useGraphView","containerRef","_s","view","setView","x","y","zoom","isPanning","setIsPanning","panStartMouse","setPanStartMouse","getMousePos","e","current","rect","getBoundingClientRect","clientX","left","clientY","top","handleWheel","ctrlKey","metaKey","preventDefault","screenX","screenY","worldX","worldY","delta","deltaY","newZoom","Math","min","max","newX","newY","prev","deltaX","startPan","updatePan","dx","dy","endPan"],"sources":["/home/belac/sysFlow/src/hooks/useGraphView.ts"],"sourcesContent":["import { useState, useCallback } from \"react\";\nimport { Vec2 } from \"../models/Entity\";\n\nexport const useGraphView = (containerRef: React.RefObject<HTMLDivElement>) => {\n  const [view, setView] = useState({ x: 0, y: 0, zoom: 1 });\n  const [isPanning, setIsPanning] = useState(false);\n  const [panStartMouse, setPanStartMouse] = useState<Vec2 | null>(null);\n\n  // Helper: Convert Screen (Mouse) coords to World (Graph) coords\n  const getMousePos = useCallback((e: React.MouseEvent | MouseEvent): Vec2 => {\n    if (!containerRef.current) return { x: 0, y: 0 };\n    const rect = containerRef.current.getBoundingClientRect();\n    return {\n      x: (e.clientX - rect.left - view.x) / view.zoom,\n      y: (e.clientY - rect.top - view.y) / view.zoom\n    };\n  }, [view, containerRef]);\n\n  // Handle Zoom and Pan via Wheel\n  const handleWheel = useCallback((e: React.WheelEvent) => {\n    // Ctrl+Scroll -> Zoom\n    if (e.ctrlKey || e.metaKey) {\n      e.preventDefault();\n      if (!containerRef.current) return;\n\n      const rect = containerRef.current.getBoundingClientRect();\n      const screenX = e.clientX - rect.left;\n      const screenY = e.clientY - rect.top;\n\n      // World position before zoom\n      const worldX = (screenX - view.x) / view.zoom;\n      const worldY = (screenY - view.y) / view.zoom;\n\n      // Calc new zoom\n      const delta = -e.deltaY * 0.001;\n      const newZoom = Math.min(Math.max(0.1, view.zoom * (1 + delta)), 5);\n\n      // Adjust Pan to keep mouse over same world point\n      const newX = screenX - (worldX * newZoom);\n      const newY = screenY - (worldY * newZoom);\n\n      setView({ x: newX, y: newY, zoom: newZoom });\n    } else {\n      // Standard Pan (Shift+Scroll or Trackpad)\n      setView(prev => ({\n        ...prev,\n        x: prev.x - e.deltaX,\n        y: prev.y - e.deltaY\n      }));\n    }\n  }, [view]);\n\n  // Manual Panning Handlers (Middle Mouse / Spacebar)\n  const startPan = (e: React.MouseEvent) => {\n    setIsPanning(true);\n    setPanStartMouse({ x: e.clientX, y: e.clientY });\n  };\n\n  const updatePan = (e: React.MouseEvent) => {\n    if (!isPanning || !panStartMouse) return;\n    const dx = e.clientX - panStartMouse.x;\n    const dy = e.clientY - panStartMouse.y;\n    setView(prev => ({ ...prev, x: prev.x + dx, y: prev.y + dy }));\n    setPanStartMouse({ x: e.clientX, y: e.clientY });\n  };\n\n  const endPan = () => {\n    setIsPanning(false);\n    setPanStartMouse(null);\n  };\n\n  return {\n    view,\n    setView,\n    isPanning,\n    getMousePos,\n    handleWheel,\n    startPan,\n    updatePan,\n    endPan\n  };\n};\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAG7C,OAAO,MAAMC,YAAY,GAAIC,YAA6C,IAAK;EAAAC,EAAA;EAC7E,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGN,QAAQ,CAAC;IAAEO,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE,CAAC;IAAEC,IAAI,EAAE;EAAE,CAAC,CAAC;EACzD,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACY,aAAa,EAAEC,gBAAgB,CAAC,GAAGb,QAAQ,CAAc,IAAI,CAAC;;EAErE;EACA,MAAMc,WAAW,GAAGb,WAAW,CAAEc,CAAgC,IAAW;IAC1E,IAAI,CAACZ,YAAY,CAACa,OAAO,EAAE,OAAO;MAAET,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC;IAChD,MAAMS,IAAI,GAAGd,YAAY,CAACa,OAAO,CAACE,qBAAqB,CAAC,CAAC;IACzD,OAAO;MACLX,CAAC,EAAE,CAACQ,CAAC,CAACI,OAAO,GAAGF,IAAI,CAACG,IAAI,GAAGf,IAAI,CAACE,CAAC,IAAIF,IAAI,CAACI,IAAI;MAC/CD,CAAC,EAAE,CAACO,CAAC,CAACM,OAAO,GAAGJ,IAAI,CAACK,GAAG,GAAGjB,IAAI,CAACG,CAAC,IAAIH,IAAI,CAACI;IAC5C,CAAC;EACH,CAAC,EAAE,CAACJ,IAAI,EAAEF,YAAY,CAAC,CAAC;;EAExB;EACA,MAAMoB,WAAW,GAAGtB,WAAW,CAAEc,CAAmB,IAAK;IACvD;IACA,IAAIA,CAAC,CAACS,OAAO,IAAIT,CAAC,CAACU,OAAO,EAAE;MAC1BV,CAAC,CAACW,cAAc,CAAC,CAAC;MAClB,IAAI,CAACvB,YAAY,CAACa,OAAO,EAAE;MAE3B,MAAMC,IAAI,GAAGd,YAAY,CAACa,OAAO,CAACE,qBAAqB,CAAC,CAAC;MACzD,MAAMS,OAAO,GAAGZ,CAAC,CAACI,OAAO,GAAGF,IAAI,CAACG,IAAI;MACrC,MAAMQ,OAAO,GAAGb,CAAC,CAACM,OAAO,GAAGJ,IAAI,CAACK,GAAG;;MAEpC;MACA,MAAMO,MAAM,GAAG,CAACF,OAAO,GAAGtB,IAAI,CAACE,CAAC,IAAIF,IAAI,CAACI,IAAI;MAC7C,MAAMqB,MAAM,GAAG,CAACF,OAAO,GAAGvB,IAAI,CAACG,CAAC,IAAIH,IAAI,CAACI,IAAI;;MAE7C;MACA,MAAMsB,KAAK,GAAG,CAAChB,CAAC,CAACiB,MAAM,GAAG,KAAK;MAC/B,MAAMC,OAAO,GAAGC,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAAC,GAAG,EAAE/B,IAAI,CAACI,IAAI,IAAI,CAAC,GAAGsB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;;MAEnE;MACA,MAAMM,IAAI,GAAGV,OAAO,GAAIE,MAAM,GAAGI,OAAQ;MACzC,MAAMK,IAAI,GAAGV,OAAO,GAAIE,MAAM,GAAGG,OAAQ;MAEzC3B,OAAO,CAAC;QAAEC,CAAC,EAAE8B,IAAI;QAAE7B,CAAC,EAAE8B,IAAI;QAAE7B,IAAI,EAAEwB;MAAQ,CAAC,CAAC;IAC9C,CAAC,MAAM;MACL;MACA3B,OAAO,CAACiC,IAAI,KAAK;QACf,GAAGA,IAAI;QACPhC,CAAC,EAAEgC,IAAI,CAAChC,CAAC,GAAGQ,CAAC,CAACyB,MAAM;QACpBhC,CAAC,EAAE+B,IAAI,CAAC/B,CAAC,GAAGO,CAAC,CAACiB;MAChB,CAAC,CAAC,CAAC;IACL;EACF,CAAC,EAAE,CAAC3B,IAAI,CAAC,CAAC;;EAEV;EACA,MAAMoC,QAAQ,GAAI1B,CAAmB,IAAK;IACxCJ,YAAY,CAAC,IAAI,CAAC;IAClBE,gBAAgB,CAAC;MAAEN,CAAC,EAAEQ,CAAC,CAACI,OAAO;MAAEX,CAAC,EAAEO,CAAC,CAACM;IAAQ,CAAC,CAAC;EAClD,CAAC;EAED,MAAMqB,SAAS,GAAI3B,CAAmB,IAAK;IACzC,IAAI,CAACL,SAAS,IAAI,CAACE,aAAa,EAAE;IAClC,MAAM+B,EAAE,GAAG5B,CAAC,CAACI,OAAO,GAAGP,aAAa,CAACL,CAAC;IACtC,MAAMqC,EAAE,GAAG7B,CAAC,CAACM,OAAO,GAAGT,aAAa,CAACJ,CAAC;IACtCF,OAAO,CAACiC,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAEhC,CAAC,EAAEgC,IAAI,CAAChC,CAAC,GAAGoC,EAAE;MAAEnC,CAAC,EAAE+B,IAAI,CAAC/B,CAAC,GAAGoC;IAAG,CAAC,CAAC,CAAC;IAC9D/B,gBAAgB,CAAC;MAAEN,CAAC,EAAEQ,CAAC,CAACI,OAAO;MAAEX,CAAC,EAAEO,CAAC,CAACM;IAAQ,CAAC,CAAC;EAClD,CAAC;EAED,MAAMwB,MAAM,GAAGA,CAAA,KAAM;IACnBlC,YAAY,CAAC,KAAK,CAAC;IACnBE,gBAAgB,CAAC,IAAI,CAAC;EACxB,CAAC;EAED,OAAO;IACLR,IAAI;IACJC,OAAO;IACPI,SAAS;IACTI,WAAW;IACXS,WAAW;IACXkB,QAAQ;IACRC,SAAS;IACTG;EACF,CAAC;AACH,CAAC;AAACzC,EAAA,CA9EWF,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}