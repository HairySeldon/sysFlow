{"ast":null,"code":"var _jsxFileName = \"/home/belac/sysFlow/src/components/GraphEdgeLayer.tsx\";\nimport React from \"react\";\nimport { GraphLogic } from \"../utils/GraphLogic\"; // Adjust path to where your GraphLogic class is\n\n// Define types based on your usage\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const GraphEdgeLayer = ({\n  graph,\n  mode,\n  creatingEdge\n}) => {\n  // Helper: recursive lookup for visual position\n  const getVisualPosition = entityId => {\n    // 1. If the entity is directly visible, return its position\n    if (GraphLogic.isEntityVisible(graph, entityId)) {\n      const node = graph.nodesById[entityId];\n      const container = graph.containersById[entityId];\n      return (node === null || node === void 0 ? void 0 : node.position) || (container === null || container === void 0 ? void 0 : container.position) || null;\n    }\n\n    // 2. If hidden, look for its parent container\n    // (This finds the immediate parent. For deep nesting, you might need a recursive parent lookup in GraphLogic)\n    const parent = Object.values(graph.containersById).find(c => {\n      var _c$childContainerIds;\n      return c.nodeIds.includes(entityId) || ((_c$childContainerIds = c.childContainerIds) === null || _c$childContainerIds === void 0 ? void 0 : _c$childContainerIds.includes(entityId));\n    });\n\n    // If parent exists and is visible, snap to parent center\n    if (parent && GraphLogic.isEntityVisible(graph, parent.id)) {\n      return {\n        x: parent.position.x + parent.size.width / 2,\n        y: parent.position.y + parent.size.height / 2\n      };\n    }\n    return null;\n  };\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    style: {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"100%\",\n      height: \"100%\",\n      pointerEvents: \"none\",\n      overflow: \"visible\",\n      zIndex: 0 // Edges sit behind nodes\n    },\n    children: [Object.values(graph.edgesById).map(edge => {\n      const start = getVisualPosition(edge.sourceNodeId);\n      const end = getVisualPosition(edge.targetNodeId);\n      if (!start || !end) return null; // Both ends hidden deep inside collapsed structures\n\n      return /*#__PURE__*/_jsxDEV(\"line\", {\n        // Add offsets: If it's a node, center it (assuming 100x50 size). If it's a container (collapsed), it centers via logic above.\n        x1: start.x + (graph.nodesById[edge.sourceNodeId] ? 50 : 0),\n        y1: start.y + (graph.nodesById[edge.sourceNodeId] ? 25 : 0),\n        x2: end.x + (graph.nodesById[edge.targetNodeId] ? 50 : 0),\n        y2: end.y + (graph.nodesById[edge.targetNodeId] ? 25 : 0),\n        stroke: \"black\",\n        strokeWidth: \"2\"\n      }, edge.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this);\n    }), mode === \"edge-create\" && creatingEdge && /*#__PURE__*/_jsxDEV(\"line\", {\n      x1: creatingEdge.position.x // Mouse Position (End of line)\n      ,\n      y1: creatingEdge.position.y,\n      x2: (() => {\n        const n = graph.nodesById[creatingEdge.sourceNodeId];\n        return n ? n.position.x + 50 : 0;\n      })(),\n      y2: (() => {\n        const n = graph.nodesById[creatingEdge.sourceNodeId];\n        return n ? n.position.y + 25 : 0;\n      })(),\n      stroke: \"black\",\n      strokeWidth: \"2\",\n      strokeDasharray: \"5,5\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n};\n_c = GraphEdgeLayer;\nvar _c;\n$RefreshReg$(_c, \"GraphEdgeLayer\");","map":{"version":3,"names":["React","GraphLogic","jsxDEV","_jsxDEV","GraphEdgeLayer","graph","mode","creatingEdge","getVisualPosition","entityId","isEntityVisible","node","nodesById","container","containersById","position","parent","Object","values","find","c","_c$childContainerIds","nodeIds","includes","childContainerIds","id","x","size","width","y","height","style","top","left","pointerEvents","overflow","zIndex","children","edgesById","map","edge","start","sourceNodeId","end","targetNodeId","x1","y1","x2","y2","stroke","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","n","strokeDasharray","_c","$RefreshReg$"],"sources":["/home/belac/sysFlow/src/components/GraphEdgeLayer.tsx"],"sourcesContent":["import React from \"react\";\nimport { GraphLogic } from \"../utils/GraphLogic\"; // Adjust path to where your GraphLogic class is\n\n// Define types based on your usage\ninterface Vec2 {\n  x: number;\n  y: number;\n}\n\ninterface GraphEdgeLayerProps {\n  graph: any; // Replace 'any' with your actual Graph class type\n  mode: string;\n  creatingEdge: { sourceNodeId: string; position: Vec2 } | null;\n}\n\nexport const GraphEdgeLayer: React.FC<GraphEdgeLayerProps> = ({\n  graph,\n  mode,\n  creatingEdge,\n}) => {\n  \n  // Helper: recursive lookup for visual position\n  const getVisualPosition = (entityId: string): Vec2 | null => {\n    // 1. If the entity is directly visible, return its position\n    if (GraphLogic.isEntityVisible(graph, entityId)) {\n      const node = graph.nodesById[entityId];\n      const container = graph.containersById[entityId];\n      return node?.position || container?.position || null;\n    }\n\n    // 2. If hidden, look for its parent container\n    // (This finds the immediate parent. For deep nesting, you might need a recursive parent lookup in GraphLogic)\n    const parent = Object.values(graph.containersById).find(\n      (c: any) =>\n        c.nodeIds.includes(entityId) || c.childContainerIds?.includes(entityId)\n    );\n\n    // If parent exists and is visible, snap to parent center\n    if (parent && GraphLogic.isEntityVisible(graph, parent.id)) {\n      return {\n        x: parent.position.x + parent.size.width / 2,\n        y: parent.position.y + parent.size.height / 2,\n      };\n    }\n\n    return null;\n  };\n\n  return (\n    <svg\n      style={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        width: \"100%\",\n        height: \"100%\",\n        pointerEvents: \"none\",\n        overflow: \"visible\",\n        zIndex: 0, // Edges sit behind nodes\n      }}\n    >\n      {/* 1. Render Existing Edges */}\n      {Object.values(graph.edgesById).map((edge: any) => {\n        const start = getVisualPosition(edge.sourceNodeId);\n        const end = getVisualPosition(edge.targetNodeId);\n\n        if (!start || !end) return null; // Both ends hidden deep inside collapsed structures\n\n        return (\n          <line\n            key={edge.id}\n            // Add offsets: If it's a node, center it (assuming 100x50 size). If it's a container (collapsed), it centers via logic above.\n            x1={start.x + (graph.nodesById[edge.sourceNodeId] ? 50 : 0)}\n            y1={start.y + (graph.nodesById[edge.sourceNodeId] ? 25 : 0)}\n            x2={end.x + (graph.nodesById[edge.targetNodeId] ? 50 : 0)}\n            y2={end.y + (graph.nodesById[edge.targetNodeId] ? 25 : 0)}\n            stroke=\"black\"\n            strokeWidth=\"2\"\n          />\n        );\n      })}\n\n      {/* 2. Render Temporary \"Creating\" Edge */}\n      {mode === \"edge-create\" && creatingEdge && (\n        <line\n          x1={creatingEdge.position.x} // Mouse Position (End of line)\n          y1={creatingEdge.position.y}\n          x2={(() => {\n            const n = graph.nodesById[creatingEdge.sourceNodeId];\n            return n ? n.position.x + 50 : 0;\n          })()}\n          y2={(() => {\n            const n = graph.nodesById[creatingEdge.sourceNodeId];\n            return n ? n.position.y + 25 : 0;\n          })()}\n          stroke=\"black\"\n          strokeWidth=\"2\"\n          strokeDasharray=\"5,5\"\n        />\n      )}\n    </svg>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}