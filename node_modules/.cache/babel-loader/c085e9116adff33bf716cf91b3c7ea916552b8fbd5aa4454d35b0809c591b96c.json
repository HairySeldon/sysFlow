{"ast":null,"code":"var _jsxFileName = \"/home/belac/sysFlow/src/components/GraphPortLayer.tsx\";\nimport React from \"react\";\nimport * as GraphLogic from \"../utils/GraphLogic\"; // Adjust path\nimport { getPortPosition } from \"../utils/Geometry\"; // Adjust path\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const GraphPortLayer = ({\n  graph,\n  enablePorts,\n  onHoverPort,\n  onPortMouseDown\n}) => {\n  if (!enablePorts) return null;\n  const renderEntityPorts = entity => {\n    // Determine which ports to render\n    const portsToRender = \"nodeIds\" in entity ? GraphLogic.getRenderablePorts(graph, entity) : entity.ports || [];\n    return portsToRender.map(port => {\n      // Geometry Calculation\n      const absPos = getPortPosition(entity, port.id, graph, \"nodeIds\" in entity ? entity.size : {\n        width: 100,\n        height: 50\n      });\n\n      // Convert absolute to relative if needed (visual offset)\n      let pos = {\n        x: absPos.x,\n        y: absPos.y\n      };\n      if (\"nodeIds\" in entity) {\n        pos.x = absPos.x - entity.position.x;\n        pos.y = absPos.y - entity.position.y;\n      }\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        title: port.label,\n        style: {\n          position: \"absolute\",\n          left: pos.x - 6,\n          top: pos.y - 6,\n          width: 12,\n          height: 12,\n          borderRadius: \"50%\",\n          backgroundColor: \"#fff\",\n          border: \"2px solid #333\",\n          zIndex: 10 // Ensure ports are above nodes\n        },\n        onMouseEnter: () => onHoverPort({\n          nodeId: entity.id,\n          portId: port.id\n        }),\n        onMouseLeave: () => onHoverPort(null),\n        onMouseDown: e => onPortMouseDown(e, entity.id, port.id, port.label, pos)\n      }, port.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }, this);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [Object.values(graph.containersById).map(c => {\n      if (!GraphLogic.isEntityVisible(graph, c.id)) return null;\n      return /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: renderEntityPorts(c)\n      }, `ports-${c.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }, this);\n    }), Object.values(graph.nodesById).map(n => {\n      if (!GraphLogic.isEntityVisible(graph, n.id)) return null;\n      return /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: renderEntityPorts(n)\n      }, `ports-${n.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this);\n    })]\n  }, void 0, true);\n};\n_c = GraphPortLayer;\nvar _c;\n$RefreshReg$(_c, \"GraphPortLayer\");","map":{"version":3,"names":["React","GraphLogic","getPortPosition","jsxDEV","_jsxDEV","Fragment","_Fragment","GraphPortLayer","graph","enablePorts","onHoverPort","onPortMouseDown","renderEntityPorts","entity","portsToRender","getRenderablePorts","ports","map","port","absPos","id","size","width","height","pos","x","y","position","title","label","style","left","top","borderRadius","backgroundColor","border","zIndex","onMouseEnter","nodeId","portId","onMouseLeave","onMouseDown","e","fileName","_jsxFileName","lineNumber","columnNumber","children","Object","values","containersById","c","isEntityVisible","nodesById","n","_c","$RefreshReg$"],"sources":["/home/belac/sysFlow/src/components/GraphPortLayer.tsx"],"sourcesContent":["import React from \"react\";\nimport { GraphModel } from \"../models/GraphModel\";\nimport * as GraphLogic from \"../utils/GraphLogic\"; // Adjust path\nimport { getPortPosition } from \"../utils/Geometry\"; // Adjust path\nimport { ID, Vec2 } from \"../models/Entity\";\n\ninterface GraphPortLayerProps {\n  graph: GraphModel;\n  enablePorts: boolean;\n  hoveredPort: { nodeId: ID; portId: ID } | null;\n  onHoverPort: (info: { nodeId: ID; portId: ID } | null) => void;\n  onPortMouseDown: (e: React.MouseEvent, nodeId: ID, portId: ID, label: string, position: Vec2) => void;\n}\n\nexport const GraphPortLayer: React.FC<GraphPortLayerProps> = ({\n  graph,\n  enablePorts,\n  onHoverPort,\n  onPortMouseDown,\n}) => {\n  if (!enablePorts) return null;\n\n  const renderEntityPorts = (entity: any) => {\n    // Determine which ports to render\n    const portsToRender = \"nodeIds\" in entity\n      ? GraphLogic.getRenderablePorts(graph, entity)\n      : (entity.ports || []);\n\n    return portsToRender.map((port: any) => {\n      // Geometry Calculation\n      const absPos = getPortPosition(\n        entity,\n        port.id,\n        graph,\n        \"nodeIds\" in entity ? entity.size : { width: 100, height: 50 }\n      );\n\n      // Convert absolute to relative if needed (visual offset)\n      let pos = { x: absPos.x, y: absPos.y };\n      if (\"nodeIds\" in entity) {\n        pos.x = absPos.x - entity.position.x;\n        pos.y = absPos.y - entity.position.y;\n      }\n\n      return (\n        <div\n          key={port.id}\n          title={port.label}\n          style={{\n            position: \"absolute\",\n            left: pos.x - 6,\n            top: pos.y - 6,\n            width: 12,\n            height: 12,\n            borderRadius: \"50%\",\n            backgroundColor: \"#fff\",\n            border: \"2px solid #333\",\n            zIndex: 10, // Ensure ports are above nodes\n          }}\n          onMouseEnter={() => onHoverPort({ nodeId: entity.id, portId: port.id })}\n          onMouseLeave={() => onHoverPort(null)}\n          onMouseDown={(e) => onPortMouseDown(e, entity.id, port.id, port.label, pos)}\n        />\n      );\n    });\n  };\n\n  return (\n    <>\n      {/* Container Ports */}\n      {Object.values(graph.containersById).map((c) => {\n         if (!GraphLogic.isEntityVisible(graph, c.id)) return null;\n         return <React.Fragment key={`ports-${c.id}`}>{renderEntityPorts(c)}</React.Fragment>;\n      })}\n      \n      {/* Node Ports */}\n      {Object.values(graph.nodesById).map((n) => {\n         if (!GraphLogic.isEntityVisible(graph, n.id)) return null;\n         return <React.Fragment key={`ports-${n.id}`}>{renderEntityPorts(n)}</React.Fragment>;\n      })}\n    </>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}