{"ast":null,"code":"var _jsxFileName = \"/home/belac/sysFlow/src/components/EntityEditor.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const EntityEditor = ({\n  entityId,\n  graph,\n  position,\n  onClose,\n  onGraphChange,\n  enablePorts\n}) => {\n  _s();\n  // 1. Resolve Entity\n  const entity = graph.nodesById[entityId] || graph.containersById[entityId];\n\n  // Local state for the label so input is smooth\n  const [label, setLabel] = useState((entity === null || entity === void 0 ? void 0 : entity.label) || \"\");\n\n  // Ref to detect clicking outside\n  const ref = useRef(null);\n  useEffect(() => {\n    const handleClickOutside = event => {\n      // If click is outside the editor AND outside any potential portals (like dropdowns)\n      if (ref.current && !ref.current.contains(event.target)) {\n        onClose();\n      }\n    };\n    // Delay adding the listener slightly to avoid closing immediately upon opening\n    const timeout = setTimeout(() => {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n    }, 100);\n    return () => {\n      clearTimeout(timeout);\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [onClose]);\n  if (!entity) return null;\n\n  // --- Helper to update Graph safely ---\n  const handleUpdate = updater => {\n    // 1. Clone Graph (using your clone method or shallow copy)\n    const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n\n    // 2. Find entity in new graph\n    const target = newGraph.nodesById[entityId] || newGraph.containersById[entityId];\n\n    // 3. Apply update\n    if (target) updater(target);\n\n    // 4. Propagate change\n    onGraphChange(newGraph);\n  };\n\n  // --- Port Actions ---\n  const addPort = () => {\n    var _entity$ports;\n    const newPort = {\n      id: `p_${crypto.randomUUID()}`,\n      label: `Port ${(((_entity$ports = entity.ports) === null || _entity$ports === void 0 ? void 0 : _entity$ports.length) || 0) + 1}`\n    };\n\n    // Use the model helper if available, or manual update\n    //if (graph.addPortToEntity) {\n    // We can't use graph.addPortToEntity directly on 'graph' prop because we need to trigger change\n    // So we do it via handleUpdate or a cloned graph method\n    const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n    newGraph.addPortToEntity(entityId, newPort);\n    onGraphChange(newGraph);\n    //    } else {\n    //        // Fallback manual update\n    //        handleUpdate(e => {\n    //            if (!e.ports) e.ports = [];\n    //            e.ports.push(newPort);\n    //        });\n    //    }\n  };\n  const deletePort = portId => {\n    // Crucial: Use the helper that deletes connected edges too\n    const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n    if (newGraph.removePortAndEdges) {\n      newGraph.removePortAndEdges(entityId, portId);\n      onGraphChange(newGraph);\n    }\n  };\n  const updatePortLabel = (portId, newLabel) => {\n    handleUpdate(e => {\n      var _e$ports;\n      const p = (_e$ports = e.ports) === null || _e$ports === void 0 ? void 0 : _e$ports.find(p => p.id === portId);\n      if (p) p.label = newLabel;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    style: {\n      position: \"fixed\",\n      left: Math.min(position.x, window.innerWidth - 320),\n      // Prevent going off-screen right\n      top: Math.min(position.y, window.innerHeight - 400),\n      // Prevent going off-screen bottom\n      width: \"300px\",\n      backgroundColor: \"white\",\n      boxShadow: \"0 8px 24px rgba(0,0,0,0.15), 0 2px 6px rgba(0,0,0,0.1)\",\n      borderRadius: \"8px\",\n      zIndex: 2000,\n      display: \"flex\",\n      flexDirection: \"column\",\n      fontFamily: \"'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n      overflow: \"hidden\",\n      border: \"1px solid #e0e0e0\",\n      animation: \"fadeIn 0.15s ease-out\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"16px 16px 8px 16px\",\n        background: \"#f8f9fa\",\n        borderBottom: \"1px solid #eee\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        value: label,\n        onChange: e => {\n          setLabel(e.target.value);\n          // Debounce or direct update? Direct for responsiveness, but could be optimized.\n          handleUpdate(ent => ent.label = e.target.value);\n        },\n        placeholder: \"Add title\",\n        style: {\n          display: \"block\",\n          width: \"100%\",\n          border: \"none\",\n          background: \"transparent\",\n          fontWeight: 400,\n          fontSize: \"22px\",\n          outline: \"none\",\n          marginTop: \"8px\",\n          color: \"#202124\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"0\",\n        maxHeight: \"400px\",\n        overflowY: \"auto\"\n      },\n      children: ['collapsed' in entity && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"12px 16px\",\n          borderBottom: \"1px solid #f1f3f4\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: 12,\n            fontSize: \"14px\",\n            cursor: \"pointer\",\n            color: \"#3c4043\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: entity.collapsed,\n            onChange: () => {\n              const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n              newGraph.toggleContainerCollapsed(entity.id);\n              onGraphChange(newGraph);\n            },\n            style: {\n              width: 16,\n              height: 16\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 17\n          }, this), \"Collapse Container Content\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 12\n      }, this), enablePorts && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: \"12px 16px 8px 16px\",\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: \"13px\",\n              fontWeight: 600,\n              color: \"#5f6368\"\n            },\n            children: \"Ports\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          style: {\n            width: \"100%\",\n            borderCollapse: \"collapse\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: [(entity.ports || []).map(port => /*#__PURE__*/_jsxDEV(\"tr\", {\n              style: {\n                borderBottom: \"1px solid #f8f9fa\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                style: {\n                  padding: \"4px 16px\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: port.label,\n                  onChange: e => updatePortLabel(port.id, e.target.value),\n                  style: {\n                    width: \"100%\",\n                    padding: \"6px 0\",\n                    border: \"none\",\n                    fontSize: \"14px\",\n                    color: \"#3c4043\",\n                    outline: \"none\",\n                    background: \"transparent\"\n                  },\n                  placeholder: \"Port name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                style: {\n                  textAlign: \"right\",\n                  paddingRight: \"12px\",\n                  width: \"40px\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => deletePort(port.id),\n                  title: \"Delete Port\",\n                  style: {\n                    color: \"#5f6368\",\n                    border: \"none\",\n                    background: \"none\",\n                    cursor: \"pointer\",\n                    fontSize: \"18px\",\n                    padding: \"4px 8px\",\n                    borderRadius: \"4px\"\n                  },\n                  onMouseOver: e => {\n                    e.currentTarget.style.backgroundColor = \"#fce8e6\";\n                    e.currentTarget.style.color = \"#c5221f\";\n                  },\n                  onMouseOut: e => {\n                    e.currentTarget.style.backgroundColor = \"transparent\";\n                    e.currentTarget.style.color = \"#5f6368\";\n                  },\n                  children: \"\\xD7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 186,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 17\n              }, this)]\n            }, port.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this)), /*#__PURE__*/_jsxDEV(\"tr\", {\n              onClick: addPort,\n              style: {\n                cursor: \"pointer\"\n              },\n              onMouseOver: e => e.currentTarget.style.backgroundColor = \"#f8f9fa\",\n              onMouseOut: e => e.currentTarget.style.backgroundColor = \"transparent\",\n              children: /*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: 2,\n                style: {\n                  padding: \"10px 16px\",\n                  color: \"#1a73e8\",\n                  fontSize: \"13px\",\n                  fontWeight: 500\n                },\n                children: \"+ Add a port\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 209,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"12px 16px\",\n        background: \"#fff\",\n        borderTop: \"1px solid #f1f3f4\",\n        textAlign: \"right\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        style: {\n          padding: \"8px 24px\",\n          borderRadius: \"4px\",\n          border: \"none\",\n          background: \"#1a73e8\",\n          color: \"white\",\n          fontWeight: 500,\n          cursor: \"pointer\",\n          fontSize: \"14px\"\n        },\n        children: \"Done\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n};\n_s(EntityEditor, \"h4UNUBt8ZhG3WIwiqjP5l8YN09w=\");\n_c = EntityEditor;\nvar _c;\n$RefreshReg$(_c, \"EntityEditor\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","Fragment","_Fragment","EntityEditor","entityId","graph","position","onClose","onGraphChange","enablePorts","_s","entity","nodesById","containersById","label","setLabel","ref","handleClickOutside","event","current","contains","target","timeout","setTimeout","document","addEventListener","clearTimeout","removeEventListener","handleUpdate","updater","newGraph","clone","Object","assign","create","getPrototypeOf","addPort","_entity$ports","newPort","id","crypto","randomUUID","ports","length","addPortToEntity","deletePort","portId","removePortAndEdges","updatePortLabel","newLabel","e","_e$ports","p","find","style","left","Math","min","x","window","innerWidth","top","y","innerHeight","width","backgroundColor","boxShadow","borderRadius","zIndex","display","flexDirection","fontFamily","overflow","border","animation","children","padding","background","borderBottom","value","onChange","ent","placeholder","fontWeight","fontSize","outline","marginTop","color","fileName","_jsxFileName","lineNumber","columnNumber","maxHeight","overflowY","alignItems","gap","cursor","type","checked","collapsed","toggleContainerCollapsed","height","justifyContent","borderCollapse","map","port","textAlign","paddingRight","onClick","title","onMouseOver","currentTarget","onMouseOut","colSpan","borderTop","_c","$RefreshReg$"],"sources":["/home/belac/sysFlow/src/components/EntityEditor.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Entity, ID, Port } from \"../models/Entity\";\nimport { GraphModel } from \"../models/GraphModel\";\n\ninterface EntityEditorProps {\n  entityId: ID;\n  graph: GraphModel;\n  position: { x: number; y: number }; // Screen position to anchor popup\n  onClose: () => void;\n  onGraphChange: (newGraph: GraphModel) => void;\n  enablePorts: Boolean;\n}\n\nexport const EntityEditor: React.FC<EntityEditorProps> = ({ \n  entityId, graph, position, onClose, onGraphChange, enablePorts \n}) => {\n  // 1. Resolve Entity\n  const entity = graph.nodesById[entityId] || graph.containersById[entityId];\n  \n  // Local state for the label so input is smooth\n  const [label, setLabel] = useState(entity?.label || \"\");\n  \n  // Ref to detect clicking outside\n  const ref = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      // If click is outside the editor AND outside any potential portals (like dropdowns)\n      if (ref.current && !ref.current.contains(event.target as Node)) {\n        onClose();\n      }\n    };\n    // Delay adding the listener slightly to avoid closing immediately upon opening\n    const timeout = setTimeout(() => {\n        document.addEventListener(\"mousedown\", handleClickOutside);\n    }, 100);\n    \n    return () => {\n        clearTimeout(timeout);\n        document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [onClose]);\n\n  if (!entity) return null;\n\n  // --- Helper to update Graph safely ---\n  const handleUpdate = (updater: (e: Entity) => void) => {\n    // 1. Clone Graph (using your clone method or shallow copy)\n    const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n    \n    // 2. Find entity in new graph\n    const target = newGraph.nodesById[entityId] || newGraph.containersById[entityId];\n    \n    // 3. Apply update\n    if (target) updater(target);\n    \n    // 4. Propagate change\n    onGraphChange(newGraph);\n  };\n\n  // --- Port Actions ---\n  const addPort = () => {\n    const newPort: Port = { \n        id: `p_${crypto.randomUUID()}`, \n        label: `Port ${(entity.ports?.length || 0) + 1}` \n    };\n    \n    // Use the model helper if available, or manual update\n    //if (graph.addPortToEntity) {\n        // We can't use graph.addPortToEntity directly on 'graph' prop because we need to trigger change\n        // So we do it via handleUpdate or a cloned graph method\n        const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n        newGraph.addPortToEntity(entityId, newPort);\n        onGraphChange(newGraph);\n//    } else {\n//        // Fallback manual update\n//        handleUpdate(e => {\n//            if (!e.ports) e.ports = [];\n//            e.ports.push(newPort);\n//        });\n//    }\n  };\n\n  const deletePort = (portId: string) => {\n    // Crucial: Use the helper that deletes connected edges too\n    const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n    if (newGraph.removePortAndEdges) {\n        newGraph.removePortAndEdges(entityId, portId);\n        onGraphChange(newGraph);\n    }\n  };\n\n  const updatePortLabel = (portId: string, newLabel: string) => {\n    handleUpdate(e => {\n        const p = e.ports?.find(p => p.id === portId);\n        if (p) p.label = newLabel;\n    });\n  };\n\n  return (\n    <div \n      ref={ref}\n      style={{\n        position: \"fixed\", \n        left: Math.min(position.x, window.innerWidth - 320), // Prevent going off-screen right\n        top: Math.min(position.y, window.innerHeight - 400), // Prevent going off-screen bottom\n        width: \"300px\",\n        backgroundColor: \"white\",\n        boxShadow: \"0 8px 24px rgba(0,0,0,0.15), 0 2px 6px rgba(0,0,0,0.1)\",\n        borderRadius: \"8px\",\n        zIndex: 2000,\n        display: \"flex\",\n        flexDirection: \"column\",\n        fontFamily: \"'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n        overflow: \"hidden\",\n        border: \"1px solid #e0e0e0\",\n        animation: \"fadeIn 0.15s ease-out\"\n      }}\n    >\n      {/* Header */}\n      <div style={{ padding: \"16px 16px 8px 16px\", background: \"#f8f9fa\", borderBottom: \"1px solid #eee\" }}>\n        <input \n          value={label}\n          onChange={(e) => {\n            setLabel(e.target.value);\n            // Debounce or direct update? Direct for responsiveness, but could be optimized.\n            handleUpdate(ent => ent.label = e.target.value);\n          }}\n          placeholder=\"Add title\"\n          style={{ \n            display: \"block\", width: \"100%\", border: \"none\", background: \"transparent\", \n            fontWeight: 400, fontSize: \"22px\", outline: \"none\", marginTop: \"8px\", color: \"#202124\"\n          }}\n        />\n      </div>\n\n      <div style={{ padding: \"0\", maxHeight: \"400px\", overflowY: \"auto\" }}>\n        \n        {/* Container Specific: Collapse Toggle */}\n        {'collapsed' in entity && (\n           <div style={{padding: \"12px 16px\", borderBottom: \"1px solid #f1f3f4\"}}>\n              <label style={{display:\"flex\", alignItems:\"center\", gap: 12, fontSize: \"14px\", cursor: \"pointer\", color: \"#3c4043\"}}>\n                <input \n                  type=\"checkbox\" \n                  checked={(entity as any).collapsed} \n                  onChange={() => {\n                     const newGraph = graph.clone ? graph.clone() : Object.assign(Object.create(Object.getPrototypeOf(graph)), graph);\n                     newGraph.toggleContainerCollapsed(entity.id);\n                     onGraphChange(newGraph);\n                  }}\n                  style={{width: 16, height: 16}}\n                />\n                Collapse Container Content\n              </label>\n           </div>\n        )}\n\n        {/* Port Manager Header */}\n        {enablePorts && (\n        <>\n        <div style={{\n            padding: \"12px 16px 8px 16px\", \n            display:\"flex\", justifyContent:\"space-between\", alignItems:\"center\"\n        }}>\n            <span style={{fontSize: \"13px\", fontWeight: 600, color: \"#5f6368\"}}>Ports</span>\n        </div>\n\n        {/* Port List */}\n        <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\n          <tbody>\n            {(entity.ports || []).map((port) => (\n              <tr key={port.id} style={{ borderBottom: \"1px solid #f8f9fa\" }}>\n                <td style={{ padding: \"4px 16px\" }}>\n                  <input\n                    value={port.label}\n                    onChange={(e) => updatePortLabel(port.id, e.target.value)}\n                    style={{ \n                        width: \"100%\", padding: \"6px 0\", border: \"none\", \n                        fontSize: \"14px\", color: \"#3c4043\", outline: \"none\",\n                        background: \"transparent\"\n                    }}\n                    placeholder=\"Port name\"\n                  />\n                </td>\n                <td style={{ textAlign: \"right\", paddingRight: \"12px\", width: \"40px\" }}>\n                  <button \n                    onClick={() => deletePort(port.id)}\n                    title=\"Delete Port\"\n                    style={{ \n                        color: \"#5f6368\", border: \"none\", background: \"none\", \n                        cursor: \"pointer\", fontSize: \"18px\", padding: \"4px 8px\", borderRadius: \"4px\"\n                    }}\n                    onMouseOver={(e) => {e.currentTarget.style.backgroundColor = \"#fce8e6\"; e.currentTarget.style.color = \"#c5221f\"}}\n                    onMouseOut={(e) => {e.currentTarget.style.backgroundColor = \"transparent\"; e.currentTarget.style.color = \"#5f6368\"}}\n                  >\n                    &times;\n                  </button>\n                </td>\n              </tr>\n            ))}\n            \n            {/* Add Port Row */}\n            <tr \n                onClick={addPort}\n                style={{ cursor: \"pointer\" }}\n                onMouseOver={(e) => e.currentTarget.style.backgroundColor = \"#f8f9fa\"}\n                onMouseOut={(e) => e.currentTarget.style.backgroundColor = \"transparent\"}\n            >\n                <td colSpan={2} style={{ padding: \"10px 16px\", color: \"#1a73e8\", fontSize: \"13px\", fontWeight: 500 }}>\n                    + Add a port\n                </td>\n            </tr>\n          </tbody>\n        </table>\n      </>\n      )}\n      </div>\n      \n      {/* Footer */}\n      <div style={{padding: \"12px 16px\", background: \"#fff\", borderTop: \"1px solid #f1f3f4\", textAlign: \"right\"}}>\n          <button \n            onClick={onClose} \n            style={{\n                padding: \"8px 24px\", borderRadius: \"4px\", border: \"none\", \n                background: \"#1a73e8\", color: \"white\", fontWeight: 500, cursor: \"pointer\", fontSize: \"14px\"\n            }}\n          >\n            Done\n          </button>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}